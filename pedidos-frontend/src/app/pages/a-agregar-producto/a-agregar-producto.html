<section class="container mx-auto section">
    <div class="up-page py-2 px-6 section40">
        <h2>{{ isEditMode ? 'Editar producto' : 'Agregar producto' }}</h2>
        <div>Bienvenido, {{nameOfUser}}</div>
    </div>
    <div class="main-page">

        <p class="pb-8"><em>(*)</em>: Campo obligario.</p>

        <form [formGroup]="productoForm" class="space-y-6 py-4 mx-auto" novalidate>
            <div class="columns-form">
                <div class="form-left">
                    <div class="block mb-12">
                        <label class="block mb-1 font-medium">Nombre del producto<em>(*)</em></label>
                        <input type="text" formControlName="name" class="w-full px-4 py-3" />
                        <p *ngIf="productoForm.get('name')?.touched && productoForm.get('name')?.invalid"
                            class="text-red-600 text-sm mt-1 txt-validate">
                            El nombre es obligatorio.
                        </p>
                    </div>

                    <div class="block mb-12">
                        <label class="block mb-1 font-medium">Tipo de vehículo<em>(*)</em></label>

                        <select formControlName="type_vehicle_id" class="w-full px-4 py-3">
                            <option [ngValue]="null" disabled selected>Seleccione un vehículo</option>
                            <option *ngFor="let v of (vehicles$ | async)" [value]="v.type_vehicle_id">
                                {{ v.name }}
                            </option>
                        </select>

                        <p *ngIf="productoForm.get('type_vehicle_id')?.touched && productoForm.get('type_vehicle_id')?.errors?.['required']"
                            class="text-red-600 text-sm mt-1 txt-validate">
                            El tipo de vehículo es obligatorio.
                        </p>
                    </div>

                    <div class="block mb-12">
                        <label class="block mb-1 font-medium">Ficha técnica (URL de la ficha en Intical)</label>
                        <input type="text" formControlName="spec_sheet_url" class="w-full px-4 py-3" />
                        <!-- <p *ngIf="productoForm.get('spec_sheet_url')?.touched && productoForm.get('spec_sheet_url')?.invalid"
                            class="text-red-600 text-sm mt-1 txt-validate">
                            La ficha técnica es obligatoria.
                        </p> -->
                    </div>

                </div>
                <div class="form-right">
                    <div class="block mb-12">
                        <label class="block mb-1 font-medium">Código del producto<em>(*)</em></label>
                        <input type="number" formControlName="code" class="w-full px-4 py-3" />
                        <p *ngIf="productoForm.get('code')?.touched && productoForm.get('code')?.invalid"
                            class="text-red-600 text-sm mt-1 txt-validate">
                            El código es obligatorio.
                        </p>
                    </div>
                    <div class="block mb-12">
                        <label class="block mb-1 font-medium">Unidad de medida<em>(*)</em></label>
                        <input type="text" formControlName="type_unit" class="w-full px-4 py-3" />
                        <p *ngIf="productoForm.get('type_unit')?.touched && productoForm.get('type_unit')?.invalid"
                            class="text-red-600 text-sm mt-1 txt-validate">
                            La unidad es obligatoria.
                        </p>
                    </div>

                </div>
            </div>

            <div *ngIf="showError && typeError" class="mt-3 block w-full text-red-600 text-xs txt-error">
                <svg xmlns="http://www.w3.org/2000/svg"
                    viewBox="0 0 640 640"><!--!Font Awesome Pro v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2025 Fonticons, Inc.-->
                    <path
                        d="M320 64C334.7 64 348.2 72.1 355.2 85L571.2 485C577.9 497.4 577.6 512.4 570.4 524.5C563.2 536.6 550.1 544 536 544L104 544C89.9 544 76.9 536.6 69.6 524.5C62.3 512.4 62.1 497.4 68.8 485L284.8 85C291.8 72.1 305.3 64 320 64zM320 232C306.7 232 296 242.7 296 256L296 368C296 381.3 306.7 392 320 392C333.3 392 344 381.3 344 368L344 256C344 242.7 333.3 232 320 232zM346.7 448C347.3 438.1 342.4 428.7 333.9 423.5C325.4 418.4 314.7 418.4 306.2 423.5C297.7 428.7 292.8 438.1 293.4 448C292.8 457.9 297.7 467.3 306.2 472.5C314.7 477.6 325.4 477.6 333.9 472.5C342.4 467.3 347.3 457.9 346.7 448z" />
                </svg>
                <span>{{ typeError }}</span>
            </div>

            <div class="container-btns">
                <button type="button" (click)="submit()" class="btn">
                    {{ isEditMode ? 'Guardar cambios' : 'Agregar producto' }}
                </button>
                <button (click)="volverListaProductos()" class="btn-secondary">
                    Volver
                </button>
            </div>
        </form>


    </div>

    <app-modal-confirmacion [mostrar]="mostrarModalConfirmacion"
        [mensaje]="'¿Seguro que deseas volver? Los cambios no se guardarán.'" (confirmar)="confirmarVolver()"
        (cancelar)="cancelarVolver()">
    </app-modal-confirmacion>

    <div *ngIf="mostrarModalExito" class="fixed inset-0 flex items-center justify-center z-50 open-modal-exito">
        <div class="bg-white rounded shadow-md p-6 w-11/12 md:w-1/3 relative">
            <div class="flex items-center flex-col modal-icon text-center">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M320 112C434.9 112 528 205.1 528 320C528 434.9 434.9 528 320 528C205.1 528 112 434.9 112 320C112 205.1 205.1 112 320 112zM320 576C461.4 576 576 461.4 576 320C576 178.6 461.4 64 320 64C178.6 64 64 178.6 64 320C64 461.4 178.6 576 320 576zM404.4 276.7C411.4 265.5 408 250.7 396.8 243.6C385.6 236.5 370.8 240 363.7 251.2L302.3 349.5L275.3 313.5C267.3 302.9 252.3 300.7 241.7 308.7C231.1 316.7 228.9 331.7 236.9 342.3L284.9 406.3C289.6 412.6 297.2 416.2 305.1 415.9C313 415.6 320.2 411.4 324.4 404.6L404.4 276.6z"/></svg>
                <h3 class="text-gray-700">¡Hecho!</h3>
            </div>

            <div class="py-4 text-center">
                <p class="fff text-gray-700">{{titleModalExito}}</p>
            </div>

            <div class="flex justify-center pt-8 border-t border-gray-200">
                <button (click)="irAListaProductos()"
                    class="text-white font-bold py-2 px-4 rounded btn">
                    Aceptar
                </button>
            </div>
        </div>
    </div>

</section>